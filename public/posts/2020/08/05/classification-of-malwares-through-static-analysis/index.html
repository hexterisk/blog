<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:hexterisk]">
<meta name="description" content="Static analysis is the analysis of an executable file on a structural bases without executing it in controlled environment. It is the analysis of the executable&rsquo;s static attributes such as different sections and memory characteristics.
Therefore, static analysis of a PE allows extraction of a lot of metadata that can be useful in further analysis such as names of sections, imported DLLs and strings present which gives an early idea of the functions performed by the binary in question. Malicious binaries with unstructured and improperly formatted metadata (done to achieve sophisticated levels of obfuscation and anti-debugging/anti-reversing defenses) can raise suspicions since a benign PE generally has a well-formed and valid metadata. Therefore, static analysis has been a popular approach towards malware detection in PEs. Since execution of the binary is not required, this approach is much more lightweight and resource-conserving. This allows security teams and researchers quickly perform a preliminary analysis.
" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/posts/2020/08/05/classification-of-malwares-through-static-analysis/" />
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">


    <title>
        
            Classification of Malwares through Static Analysis: Pwn the world.  — A noob&#39;s attempt at blogging.
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="../../../../../main.min.723994d490d4e7b39bc5e6e49a15a79441ef3b16ff6e0d6db0d78feeca11d458.css">
<link rel="stylesheet" href="../../../../../main.min.723994d490d4e7b39bc5e6e49a15a79441ef3b16ff6e0d6db0d78feeca11d458.css">




    <link rel="apple-touch-icon" sizes="180x180" href="../../../../../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../../favicon-16x16.png">
    <link rel="manifest" href="../../../../../site.webmanifest">
    <link rel="mask-icon" href="../../../../../safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="../../../../../favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">


  <meta itemprop="name" content="Classification of Malwares through Static Analysis">
  <meta itemprop="description" content="Static analysis is the analysis of an executable file on a structural bases without executing it in controlled environment. It is the analysis of the executable’s static attributes such as different sections and memory characteristics.
Therefore, static analysis of a PE allows extraction of a lot of metadata that can be useful in further analysis such as names of sections, imported DLLs and strings present which gives an early idea of the functions performed by the binary in question. Malicious binaries with unstructured and improperly formatted metadata (done to achieve sophisticated levels of obfuscation and anti-debugging/anti-reversing defenses) can raise suspicions since a benign PE generally has a well-formed and valid metadata. Therefore, static analysis has been a popular approach towards malware detection in PEs. Since execution of the binary is not required, this approach is much more lightweight and resource-conserving. This allows security teams and researchers quickly perform a preliminary analysis.">
  <meta itemprop="datePublished" content="2020-08-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2020-08-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="503">
  <meta itemprop="keywords" content="Malwares,Machine-Learning,Pe,Headers,Sections,Windows,Images">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Classification of Malwares through Static Analysis">
  <meta name="twitter:description" content="Static analysis is the analysis of an executable file on a structural bases without executing it in controlled environment. It is the analysis of the executable’s static attributes such as different sections and memory characteristics.
Therefore, static analysis of a PE allows extraction of a lot of metadata that can be useful in further analysis such as names of sections, imported DLLs and strings present which gives an early idea of the functions performed by the binary in question. Malicious binaries with unstructured and improperly formatted metadata (done to achieve sophisticated levels of obfuscation and anti-debugging/anti-reversing defenses) can raise suspicions since a benign PE generally has a well-formed and valid metadata. Therefore, static analysis has been a popular approach towards malware detection in PEs. Since execution of the binary is not required, this approach is much more lightweight and resource-conserving. This allows security teams and researchers quickly perform a preliminary analysis.">



    <meta property="article:section" content="ml-for-sec" />



    <meta property="article:published_time" content="2020-08-05 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a class="logo" href="../../../../../">
    
        <div class="logo__content">
            <span class="logo__mark">></span>
            <span class="logo__text">cd ~/</span>
            <span class="logo__cursor"></span>
        </div>
    
</a>
<script>
    document.documentElement.style.setProperty('--logo-cursor-color', '#ed5565');
</script>

        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="http://localhost:1313/about/">About</a></li><li><a href="http://localhost:1313/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
<main class="post">

    <div class="post-info">
        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-clock">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>3 minutes

            

        </p>
    </div>

    <article>
        <h1 class="post-title">
            <a href="http://localhost:1313/posts/2020/08/05/classification-of-malwares-through-static-analysis/">Classification of Malwares through Static Analysis</a>
        </h1>

        

        <div class="post-content">
            <p>Static analysis is the analysis of an executable file on a structural bases without executing it in controlled environment. It is the analysis of the executable&rsquo;s static attributes such as different sections and memory characteristics.</p>
<p>Therefore, static analysis of a PE allows extraction of a lot of metadata that can be useful in further analysis such as names of sections, imported DLLs and strings present which gives an early idea of the functions performed by the binary in question. Malicious binaries with unstructured and improperly formatted metadata (done to achieve sophisticated levels of obfuscation and anti-debugging/anti-reversing defenses) can raise suspicions since a benign PE generally has a well-formed and valid metadata. Therefore, static analysis has been a popular approach towards malware detection in PEs. Since execution of the binary is not required, this approach is much more lightweight and resource-conserving. This allows security teams and researchers quickly perform a preliminary analysis.</p>
<p>The metadata extracted from the PEs to be used as features, however, is mostly unreliable because of it&rsquo;s extreme variance and invalidity.</p>
<p> </p>
<h2 id="feature-extraction">Feature Extraction</h2>
<p>The following features can be extracted from a PE:</p>
<ol>
<li>General File Information<br>
General information about the binary such as it&rsquo;s size and other basic information parsed from the PE header: virtual size of the binary, resources, re-locations and symbols.</li>
<li>Header Information<br>
We parse different headers and extract different data points relevant to the said headers. For example. we can extract timestamps and image characteristics from the COFF header, DLL characteristics an linker versions from the Optional header.</li>
<li>Imported Functions<br>
Parsing the IAT(Import Address Table) can tell us about the imported functions by the libraries used by the binary. These strings can be hashed and used as features. Total number of imported functions is in General File Information.</li>
<li>Exported Functions<br>
The functions exported by the binary can give us a vague idea if it works as a support to some other binary, and what functions it can perform. Total number of exported functions is in General File Information.Imported Functions</li>
<li>Section Information<br>
Properties of each section such as it&rsquo;s size, entropy and list of strings can help capture the characteristics of that section.</li>
<li>Byte Histogram<br>
A histogram can be generated from all the bytes of the binary and normalized to be used as a feature.</li>
<li>Byte-Entropy Histogram<br>
A histogram can be generated from the byte-entropy of the binary for an approximation of a byte&rsquo;s joint distribution to the entropy. It can then be normalized and used as a feature.</li>
<li>Strings<br>
Collection of subsequent printable bytes can be extremely unreliable since any random byte combination(of at least length 5) would qualify as a string. However, it provides distinct information in comparison to the byte histogram since strings can capture occurrences of URLs, registry keys and file names.</li>
</ol>
<p>These features can be used to form a general idea about the PE before executing it.</p>
<p>Sample structure info after running a PE through a parser is shown in this <a href="https://github.com/hexterisk/static-malwired/blob/master/static_info.txt">file</a>.</p>
<p>A POC working on malware classification using static analysis is in this <a href="https://github.com/hexterisk/static-malwired">repository</a>.</p>

        </div>
    </article>

    <hr />

    <div class="post-info">
        <p>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-tag meta-icon">
                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                <line x1="7" y1="7" x2="7" y2="7"></line>
            </svg><span class="tag"><a href="http://localhost:1313/%20tags/malwares">malwares</a></span><span class="tag"><a href="http://localhost:1313/%20tags/machine-learning">machine-learning</a></span><span class="tag"><a href="http://localhost:1313/%20tags/pe">pe</a></span><span class="tag"><a href="http://localhost:1313/%20tags/headers">headers</a></span><span class="tag"><a href="http://localhost:1313/%20tags/sections">sections</a></span><span class="tag"><a href="http://localhost:1313/%20tags/windows">windows</a></span><span class="tag"><a href="http://localhost:1313/%20tags/images">images</a></span>
        </p>

        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-file-text">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>503 Words</p>

        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-calendar">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>2020-08-05 05:30 &#43;0530</p>
    </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">

            
            <span class="button previous">
                <a href="http://localhost:1313/posts/2020/07/30/serial-2/">
                    <span class="button__text">Serial 2</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="http://localhost:1313/posts/2020/08/06/classification-of-malwares-through-dynamic-analysis/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Classification of Malwares through Dynamic Analysis</span>
                </a>
            </span>
            

        </div>
    </div>
    

    
</main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
    
    <div class="footer__svg">
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="30"
            height="30"
            viewBox="0 0 140 140"
            stroke="#4DB6AC"
        >
            <path stroke-width="122" stroke-dasharray="2,38" d="M9,70h122M70,9v122" />
            <path stroke-width="33" stroke-linecap="round" d="M70,30h0M110,70h0M30,110v0M70,110h0M110,110h0" />
        </svg>
    </div>
</footer>
            
        </div>

        





<script type="text/javascript" src="../../../../../bundle.min.45295cbc2d5bbc09b85caead90108f31defa5c6b650a42abb2e79d59a363e5bc2f11614e43687e66e6d47563560a45c3324b75dcb9b3a724a2955a2f1ce2f114.js" integrity="sha512-RSlcvC1bvAm4XK6tkBCPMd76XGtlCkKrsuedWaNj5bwvEWFOQ2h&#43;ZubUdWNWCkXDMkt13LmzpySilVovHOLxFA=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'G-66L1D38RLD', 'auto');
        ga('send', 'pageview');
    </script>


    </body>
</html>
