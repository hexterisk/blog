<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:hexterisk]">
<meta name="description" content="System Call Trace strace can be used to investigate system call behavior. In some cases, you may want to attach strace to a running process. To do this, you need to use the -p pid option, where pid is the process ID of the process you want to attach to.
$ strace ./ctf show_me_the_flag ➊ execve(&#34;./ctf&#34;, [&#34;./ctf&#34;, &#34;show_me_the_flag&#34;], [/* 73 vars */]) = 0 brk(NULL) = 0x1053000 access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f703477e000 access(&#34;/etc/ld.so.preload&#34;, R_OK) = -1 ENOENT (No such file or directory) ➋ open(&#34;/ch3/tls/x86_64/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or ...) stat(&#34;/ch3/tls/x86_64&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/tls/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) stat(&#34;/ch3/tls&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/x86_64/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) stat(&#34;/ch3/x86_64&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = 3 ➌ read(3, &#34;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p\t\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0775, st_size=10296, ...) = 0 mmap(NULL, 2105440, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7034358000 mprotect(0x7f7034359000, 2097152, PROT_NONE) = 0 mmap(0x7f7034559000, 8192, PROT_READ|PROT_WRITE, ..., 3, 0x1000) = 0x7f7034559000 close(3) = 0 open(&#34;/ch3/libstdc&#43;&#43;.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) open(&#34;/etc/ld.so.cache&#34;, O_RDONLY|O_CLOEXEC) = 3 fstat(3, st_mode=S_IFREG|0644, st_size=150611, ...) = 0 mmap(NULL, 150611, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f7034759000 close(3) = 0 access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) ➍ open(&#34;/usr/lib/x86_64-linux-gnu/libstdc&#43;&#43;.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0 \235\10\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=1566440, ...) = 0 mmap(NULL, 3675136, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7033fd6000 mprotect(0x7f7034148000, 2097152, PROT_NONE) = 0 mmap(0x7f7034348000, 49152, PROT_READ|PROT_WRITE, ..., 3, 0x172000) = 0x7f7034348000 mmap(0x7f7034354000, 13312, PROT_READ|PROT_WRITE, ..., -1, 0) = 0x7f7034354000 close(3) = 0 open(&#34;/ch3/libgcc_s.so.1&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libgcc_s.so.1&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p*\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=89696, ...) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034758000 mmap(NULL, 2185488, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7033dc0000 mprotect(0x7f7033dd6000, 2093056, PROT_NONE) = 0 mmap(0x7f7033fd5000, 4096, PROT_READ|PROT_WRITE, ..., 3, 0x15000) = 0x7f7033fd5000 close(3) = 0 open(&#34;/ch3/libc.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0P\t\2\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0755, st_size=1864888, ...) = 0 mmap(NULL, 3967392, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f70339f7000 mprotect(0x7f7033bb6000, 2097152, PROT_NONE) = 0 mmap(0x7f7033db6000, 24576, PROT_READ|PROT_WRITE, ..., 3, 0x1bf000) = 0x7f7033db6000 mmap(0x7f7033dbc000, 14752, PROT_READ|PROT_WRITE, ..., -1, 0) = 0x7f7033dbc000 close(3) = 0 open(&#34;/ch3/libm.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libm.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\0V\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=1088952, ...) = 0 mmap(NULL, 3178744, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f70336ee000 mprotect(0x7f70337f6000, 2093056, PROT_NONE) = 0 mmap(0x7f70339f5000, 8192, PROT_READ|PROT_WRITE, ..., 3, 0x107000) = 0x7f70339f5000 close(3) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034757000 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034756000 mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034754000 arch_prctl(ARCH_SET_FS, 0x7f7034754740) = 0 mprotect(0x7f7033db6000, 16384, PROT_READ) = 0 mprotect(0x7f70339f5000, 4096, PROT_READ) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034753000 mprotect(0x7f7034348000, 40960, PROT_READ) = 0 mprotect(0x7f7034559000, 4096, PROT_READ) = 0 mprotect(0x601000, 4096, PROT_READ) = 0 mprotect(0x7f7034780000, 4096, PROT_READ) = 0 munmap(0x7f7034759000, 150611) = 0 brk(NULL) = 0x1053000 brk(0x1085000) = 0x1085000 fstat(1, st_mode=S_IFCHR|0620, st_rdev=makedev(136, 1), ...) = 0 ➎ write(1, &#34;checking &#39;show_me_the_flag&#39;\n&#34;, 28checking &#39;show_me_the_flag&#39; ) = 28 ➏ write(1, &#34;ok\n&#34;, 3ok ) = 3 ➐ exit_group(1) = ? &#43;&#43;&#43; exited with 1 &#43;&#43;&#43; " />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://blogs.hexterisk.com/posts/2020/03/25/trace-analysis/" />
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">


    <title>
        
            Trace Analysis: Pwn the world.  — A noob&#39;s attempt at blogging.
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="../../../../../main.min.723994d490d4e7b39bc5e6e49a15a79441ef3b16ff6e0d6db0d78feeca11d458.css">
<link rel="stylesheet" href="../../../../../main.min.723994d490d4e7b39bc5e6e49a15a79441ef3b16ff6e0d6db0d78feeca11d458.css">




    <link rel="apple-touch-icon" sizes="180x180" href="../../../../../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../../favicon-16x16.png">
    <link rel="manifest" href="../../../../../site.webmanifest">
    <link rel="mask-icon" href="../../../../../safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="../../../../../favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">


  <meta itemprop="name" content="Trace Analysis">
  <meta itemprop="description" content="System Call Trace strace can be used to investigate system call behavior. In some cases, you may want to attach strace to a running process. To do this, you need to use the -p pid option, where pid is the process ID of the process you want to attach to.
$ strace ./ctf show_me_the_flag ➊ execve(&#34;./ctf&#34;, [&#34;./ctf&#34;, &#34;show_me_the_flag&#34;], [/* 73 vars */]) = 0 brk(NULL) = 0x1053000 access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f703477e000 access(&#34;/etc/ld.so.preload&#34;, R_OK) = -1 ENOENT (No such file or directory) ➋ open(&#34;/ch3/tls/x86_64/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or ...) stat(&#34;/ch3/tls/x86_64&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/tls/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) stat(&#34;/ch3/tls&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/x86_64/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) stat(&#34;/ch3/x86_64&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = 3 ➌ read(3, &#34;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p\t\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0775, st_size=10296, ...) = 0 mmap(NULL, 2105440, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7034358000 mprotect(0x7f7034359000, 2097152, PROT_NONE) = 0 mmap(0x7f7034559000, 8192, PROT_READ|PROT_WRITE, ..., 3, 0x1000) = 0x7f7034559000 close(3) = 0 open(&#34;/ch3/libstdc&#43;&#43;.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) open(&#34;/etc/ld.so.cache&#34;, O_RDONLY|O_CLOEXEC) = 3 fstat(3, st_mode=S_IFREG|0644, st_size=150611, ...) = 0 mmap(NULL, 150611, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f7034759000 close(3) = 0 access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) ➍ open(&#34;/usr/lib/x86_64-linux-gnu/libstdc&#43;&#43;.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0 \235\10\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=1566440, ...) = 0 mmap(NULL, 3675136, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7033fd6000 mprotect(0x7f7034148000, 2097152, PROT_NONE) = 0 mmap(0x7f7034348000, 49152, PROT_READ|PROT_WRITE, ..., 3, 0x172000) = 0x7f7034348000 mmap(0x7f7034354000, 13312, PROT_READ|PROT_WRITE, ..., -1, 0) = 0x7f7034354000 close(3) = 0 open(&#34;/ch3/libgcc_s.so.1&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libgcc_s.so.1&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p*\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=89696, ...) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034758000 mmap(NULL, 2185488, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7033dc0000 mprotect(0x7f7033dd6000, 2093056, PROT_NONE) = 0 mmap(0x7f7033fd5000, 4096, PROT_READ|PROT_WRITE, ..., 3, 0x15000) = 0x7f7033fd5000 close(3) = 0 open(&#34;/ch3/libc.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0P\t\2\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0755, st_size=1864888, ...) = 0 mmap(NULL, 3967392, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f70339f7000 mprotect(0x7f7033bb6000, 2097152, PROT_NONE) = 0 mmap(0x7f7033db6000, 24576, PROT_READ|PROT_WRITE, ..., 3, 0x1bf000) = 0x7f7033db6000 mmap(0x7f7033dbc000, 14752, PROT_READ|PROT_WRITE, ..., -1, 0) = 0x7f7033dbc000 close(3) = 0 open(&#34;/ch3/libm.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libm.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\0V\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=1088952, ...) = 0 mmap(NULL, 3178744, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f70336ee000 mprotect(0x7f70337f6000, 2093056, PROT_NONE) = 0 mmap(0x7f70339f5000, 8192, PROT_READ|PROT_WRITE, ..., 3, 0x107000) = 0x7f70339f5000 close(3) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034757000 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034756000 mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034754000 arch_prctl(ARCH_SET_FS, 0x7f7034754740) = 0 mprotect(0x7f7033db6000, 16384, PROT_READ) = 0 mprotect(0x7f70339f5000, 4096, PROT_READ) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034753000 mprotect(0x7f7034348000, 40960, PROT_READ) = 0 mprotect(0x7f7034559000, 4096, PROT_READ) = 0 mprotect(0x601000, 4096, PROT_READ) = 0 mprotect(0x7f7034780000, 4096, PROT_READ) = 0 munmap(0x7f7034759000, 150611) = 0 brk(NULL) = 0x1053000 brk(0x1085000) = 0x1085000 fstat(1, st_mode=S_IFCHR|0620, st_rdev=makedev(136, 1), ...) = 0 ➎ write(1, &#34;checking &#39;show_me_the_flag&#39;\n&#34;, 28checking &#39;show_me_the_flag&#39; ) = 28 ➏ write(1, &#34;ok\n&#34;, 3ok ) = 3 ➐ exit_group(1) = ? &#43;&#43;&#43; exited with 1 &#43;&#43;&#43; ">
  <meta itemprop="datePublished" content="2020-03-25T00:00:00+00:00">
  <meta itemprop="dateModified" content="2020-03-25T00:00:00+00:00">
  <meta itemprop="wordCount" content="1333">
  <meta itemprop="keywords" content="Binary,Rev,Reversing,C,Pe,Windows">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Trace Analysis">
  <meta name="twitter:description" content="System Call Trace strace can be used to investigate system call behavior. In some cases, you may want to attach strace to a running process. To do this, you need to use the -p pid option, where pid is the process ID of the process you want to attach to.
$ strace ./ctf show_me_the_flag ➊ execve(&#34;./ctf&#34;, [&#34;./ctf&#34;, &#34;show_me_the_flag&#34;], [/* 73 vars */]) = 0 brk(NULL) = 0x1053000 access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f703477e000 access(&#34;/etc/ld.so.preload&#34;, R_OK) = -1 ENOENT (No such file or directory) ➋ open(&#34;/ch3/tls/x86_64/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or ...) stat(&#34;/ch3/tls/x86_64&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/tls/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) stat(&#34;/ch3/tls&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/x86_64/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) stat(&#34;/ch3/x86_64&#34;, 0x7ffcc6987ab0) = -1 ENOENT (No such file or directory) open(&#34;/ch3/lib5ae9b7f.so&#34;, O_RDONLY|O_CLOEXEC) = 3 ➌ read(3, &#34;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p\t\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0775, st_size=10296, ...) = 0 mmap(NULL, 2105440, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7034358000 mprotect(0x7f7034359000, 2097152, PROT_NONE) = 0 mmap(0x7f7034559000, 8192, PROT_READ|PROT_WRITE, ..., 3, 0x1000) = 0x7f7034559000 close(3) = 0 open(&#34;/ch3/libstdc&#43;&#43;.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) open(&#34;/etc/ld.so.cache&#34;, O_RDONLY|O_CLOEXEC) = 3 fstat(3, st_mode=S_IFREG|0644, st_size=150611, ...) = 0 mmap(NULL, 150611, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f7034759000 close(3) = 0 access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) ➍ open(&#34;/usr/lib/x86_64-linux-gnu/libstdc&#43;&#43;.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0 \235\10\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=1566440, ...) = 0 mmap(NULL, 3675136, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7033fd6000 mprotect(0x7f7034148000, 2097152, PROT_NONE) = 0 mmap(0x7f7034348000, 49152, PROT_READ|PROT_WRITE, ..., 3, 0x172000) = 0x7f7034348000 mmap(0x7f7034354000, 13312, PROT_READ|PROT_WRITE, ..., -1, 0) = 0x7f7034354000 close(3) = 0 open(&#34;/ch3/libgcc_s.so.1&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libgcc_s.so.1&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0p*\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=89696, ...) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034758000 mmap(NULL, 2185488, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f7033dc0000 mprotect(0x7f7033dd6000, 2093056, PROT_NONE) = 0 mmap(0x7f7033fd5000, 4096, PROT_READ|PROT_WRITE, ..., 3, 0x15000) = 0x7f7033fd5000 close(3) = 0 open(&#34;/ch3/libc.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0P\t\2\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0755, st_size=1864888, ...) = 0 mmap(NULL, 3967392, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f70339f7000 mprotect(0x7f7033bb6000, 2097152, PROT_NONE) = 0 mmap(0x7f7033db6000, 24576, PROT_READ|PROT_WRITE, ..., 3, 0x1bf000) = 0x7f7033db6000 mmap(0x7f7033dbc000, 14752, PROT_READ|PROT_WRITE, ..., -1, 0) = 0x7f7033dbc000 close(3) = 0 open(&#34;/ch3/libm.so.6&#34;, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) access(&#34;/etc/ld.so.nohwcap&#34;, F_OK) = -1 ENOENT (No such file or directory) open(&#34;/lib/x86_64-linux-gnu/libm.so.6&#34;, O_RDONLY|O_CLOEXEC) = 3 read(3, &#34;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\0V\0\0\0\0\0\0&#34;..., 832) = 832 fstat(3, st_mode=S_IFREG|0644, st_size=1088952, ...) = 0 mmap(NULL, 3178744, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f70336ee000 mprotect(0x7f70337f6000, 2093056, PROT_NONE) = 0 mmap(0x7f70339f5000, 8192, PROT_READ|PROT_WRITE, ..., 3, 0x107000) = 0x7f70339f5000 close(3) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034757000 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034756000 mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034754000 arch_prctl(ARCH_SET_FS, 0x7f7034754740) = 0 mprotect(0x7f7033db6000, 16384, PROT_READ) = 0 mprotect(0x7f70339f5000, 4096, PROT_READ) = 0 mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f7034753000 mprotect(0x7f7034348000, 40960, PROT_READ) = 0 mprotect(0x7f7034559000, 4096, PROT_READ) = 0 mprotect(0x601000, 4096, PROT_READ) = 0 mprotect(0x7f7034780000, 4096, PROT_READ) = 0 munmap(0x7f7034759000, 150611) = 0 brk(NULL) = 0x1053000 brk(0x1085000) = 0x1085000 fstat(1, st_mode=S_IFCHR|0620, st_rdev=makedev(136, 1), ...) = 0 ➎ write(1, &#34;checking &#39;show_me_the_flag&#39;\n&#34;, 28checking &#39;show_me_the_flag&#39; ) = 28 ➏ write(1, &#34;ok\n&#34;, 3ok ) = 3 ➐ exit_group(1) = ? &#43;&#43;&#43; exited with 1 &#43;&#43;&#43; ">



    <meta property="article:section" content="basic-binary-analysis" />



    <meta property="article:published_time" content="2020-03-25 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a class="logo" href="../../../../../">
    
        <div class="logo__content">
            <span class="logo__mark">></span>
            <span class="logo__text">cd ~/</span>
            <span class="logo__cursor"></span>
        </div>
    
</a>
<script>
    document.documentElement.style.setProperty('--logo-cursor-color', '#ed5565');
</script>

        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://blogs.hexterisk.com/about/">About</a></li><li><a href="https://blogs.hexterisk.com/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
<main class="post">

    <div class="post-info">
        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-clock">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>7 minutes

            

        </p>
    </div>

    <article>
        <h1 class="post-title">
            <a href="https://blogs.hexterisk.com/posts/2020/03/25/trace-analysis/">Trace Analysis</a>
        </h1>

        

        <div class="post-content">
            <h2 id="system-call-trace">System Call Trace</h2>
<p><strong>strace</strong> can be used to investigate system call behavior. In some cases, you may want to attach strace to a running process. To do this, you need to use the -p pid option, where pid is the process ID of the process you want to attach to.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> strace .<span style="color:#f92672">/</span>ctf show_me_the_flag
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➊</span> <span style="color:#a6e22e">execve</span>(<span style="color:#e6db74">&#34;./ctf&#34;</span>, [<span style="color:#e6db74">&#34;./ctf&#34;</span>, <span style="color:#e6db74">&#34;show_me_the_flag&#34;</span>], [<span style="color:#75715e">/* 73 vars */</span>]) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">brk</span>(NULL) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1053000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">access</span>(<span style="color:#e6db74">&#34;/etc/ld.so.nohwcap&#34;</span>, F_OK) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">8192</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_ANONYMOUS, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f703477e000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">access</span>(<span style="color:#e6db74">&#34;/etc/ld.so.preload&#34;</span>, R_OK) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➋</span> <span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/tls/x86_64/lib5ae9b7f.so&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or ...)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stat</span>(<span style="color:#e6db74">&#34;/ch3/tls/x86_64&#34;</span>, <span style="color:#ae81ff">0x7ffcc6987ab0</span>) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/tls/lib5ae9b7f.so&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stat</span>(<span style="color:#e6db74">&#34;/ch3/tls&#34;</span>, <span style="color:#ae81ff">0x7ffcc6987ab0</span>) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/x86_64/lib5ae9b7f.so&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stat</span>(<span style="color:#e6db74">&#34;/ch3/x86_64&#34;</span>, <span style="color:#ae81ff">0x7ffcc6987ab0</span>) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/lib5ae9b7f.so&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➌</span> <span style="color:#a6e22e">read</span>(<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\177</span><span style="color:#e6db74">ELF</span><span style="color:#ae81ff">\2\1\1\0\0\0\0\0\0\0\0\0\3\0</span><span style="color:#e6db74">&gt;</span><span style="color:#ae81ff">\0\1\0\0\0</span><span style="color:#e6db74">p</span><span style="color:#ae81ff">\t\0\0\0\0\0\0</span><span style="color:#e6db74">&#34;</span>..., <span style="color:#ae81ff">832</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">832</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fstat</span>(<span style="color:#ae81ff">3</span>, st_mode<span style="color:#f92672">=</span>S_IFREG<span style="color:#f92672">|</span><span style="color:#ae81ff">0775</span>, st_size<span style="color:#f92672">=</span><span style="color:#ae81ff">10296</span>, ...) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">2105440</span>, PROT_READ<span style="color:#f92672">|</span>PROT_EXEC, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_DENYWRITE, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034358000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7034359000</span>, <span style="color:#ae81ff">2097152</span>, PROT_NONE) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(<span style="color:#ae81ff">0x7f7034559000</span>, <span style="color:#ae81ff">8192</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, ..., <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x1000</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034559000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close</span>(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/libstdc++.so.6&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/etc/ld.so.cache&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fstat</span>(<span style="color:#ae81ff">3</span>, st_mode<span style="color:#f92672">=</span>S_IFREG<span style="color:#f92672">|</span><span style="color:#ae81ff">0644</span>, st_size<span style="color:#f92672">=</span><span style="color:#ae81ff">150611</span>, ...) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">150611</span>, PROT_READ, MAP_PRIVATE, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034759000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close</span>(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">access</span>(<span style="color:#e6db74">&#34;/etc/ld.so.nohwcap&#34;</span>, F_OK) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➍</span> <span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/usr/lib/x86_64-linux-gnu/libstdc++.so.6&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">read</span>(<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\177</span><span style="color:#e6db74">ELF</span><span style="color:#ae81ff">\2\1\1\3\0\0\0\0\0\0\0\0\3\0</span><span style="color:#e6db74">&gt;</span><span style="color:#ae81ff">\0\1\0\0\0</span><span style="color:#e6db74"> </span><span style="color:#ae81ff">\235\10\0\0\0\0\0</span><span style="color:#e6db74">&#34;</span>..., <span style="color:#ae81ff">832</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">832</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fstat</span>(<span style="color:#ae81ff">3</span>, st_mode<span style="color:#f92672">=</span>S_IFREG<span style="color:#f92672">|</span><span style="color:#ae81ff">0644</span>, st_size<span style="color:#f92672">=</span><span style="color:#ae81ff">1566440</span>, ...) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">3675136</span>, PROT_READ<span style="color:#f92672">|</span>PROT_EXEC, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_DENYWRITE, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7033fd6000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7034148000</span>, <span style="color:#ae81ff">2097152</span>, PROT_NONE) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(<span style="color:#ae81ff">0x7f7034348000</span>, <span style="color:#ae81ff">49152</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, ..., <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x172000</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034348000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(<span style="color:#ae81ff">0x7f7034354000</span>, <span style="color:#ae81ff">13312</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, ..., <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034354000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close</span>(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/libgcc_s.so.1&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">access</span>(<span style="color:#e6db74">&#34;/etc/ld.so.nohwcap&#34;</span>, F_OK) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libgcc_s.so.1&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">read</span>(<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\177</span><span style="color:#e6db74">ELF</span><span style="color:#ae81ff">\2\1\1\0\0\0\0\0\0\0\0\0\3\0</span><span style="color:#e6db74">&gt;</span><span style="color:#ae81ff">\0\1\0\0\0</span><span style="color:#e6db74">p*</span><span style="color:#ae81ff">\0\0\0\0\0\0</span><span style="color:#e6db74">&#34;</span>..., <span style="color:#ae81ff">832</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">832</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fstat</span>(<span style="color:#ae81ff">3</span>, st_mode<span style="color:#f92672">=</span>S_IFREG<span style="color:#f92672">|</span><span style="color:#ae81ff">0644</span>, st_size<span style="color:#f92672">=</span><span style="color:#ae81ff">89696</span>, ...) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">4096</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_ANONYMOUS, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034758000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">2185488</span>, PROT_READ<span style="color:#f92672">|</span>PROT_EXEC, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_DENYWRITE, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7033dc0000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7033dd6000</span>, <span style="color:#ae81ff">2093056</span>, PROT_NONE) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(<span style="color:#ae81ff">0x7f7033fd5000</span>, <span style="color:#ae81ff">4096</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, ..., <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x15000</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7033fd5000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close</span>(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/libc.so.6&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">access</span>(<span style="color:#e6db74">&#34;/etc/ld.so.nohwcap&#34;</span>, F_OK) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">read</span>(<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\177</span><span style="color:#e6db74">ELF</span><span style="color:#ae81ff">\2\1\1\3\0\0\0\0\0\0\0\0\3\0</span><span style="color:#e6db74">&gt;</span><span style="color:#ae81ff">\0\1\0\0\0</span><span style="color:#e6db74">P</span><span style="color:#ae81ff">\t\2\0\0\0\0\0</span><span style="color:#e6db74">&#34;</span>..., <span style="color:#ae81ff">832</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">832</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fstat</span>(<span style="color:#ae81ff">3</span>, st_mode<span style="color:#f92672">=</span>S_IFREG<span style="color:#f92672">|</span><span style="color:#ae81ff">0755</span>, st_size<span style="color:#f92672">=</span><span style="color:#ae81ff">1864888</span>, ...) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">3967392</span>, PROT_READ<span style="color:#f92672">|</span>PROT_EXEC, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_DENYWRITE, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f70339f7000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7033bb6000</span>, <span style="color:#ae81ff">2097152</span>, PROT_NONE) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(<span style="color:#ae81ff">0x7f7033db6000</span>, <span style="color:#ae81ff">24576</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, ..., <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x1bf000</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7033db6000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(<span style="color:#ae81ff">0x7f7033dbc000</span>, <span style="color:#ae81ff">14752</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, ..., <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7033dbc000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close</span>(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/ch3/libm.so.6&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">access</span>(<span style="color:#e6db74">&#34;/etc/ld.so.nohwcap&#34;</span>, F_OK) <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">ENOENT</span> (No such file or directory)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">open</span>(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libm.so.6&#34;</span>, O_RDONLY<span style="color:#f92672">|</span>O_CLOEXEC) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">read</span>(<span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\177</span><span style="color:#e6db74">ELF</span><span style="color:#ae81ff">\2\1\1\3\0\0\0\0\0\0\0\0\3\0</span><span style="color:#e6db74">&gt;</span><span style="color:#ae81ff">\0\1\0\0\0\0</span><span style="color:#e6db74">V</span><span style="color:#ae81ff">\0\0\0\0\0\0</span><span style="color:#e6db74">&#34;</span>..., <span style="color:#ae81ff">832</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">832</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fstat</span>(<span style="color:#ae81ff">3</span>, st_mode<span style="color:#f92672">=</span>S_IFREG<span style="color:#f92672">|</span><span style="color:#ae81ff">0644</span>, st_size<span style="color:#f92672">=</span><span style="color:#ae81ff">1088952</span>, ...) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">3178744</span>, PROT_READ<span style="color:#f92672">|</span>PROT_EXEC, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_DENYWRITE, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f70336ee000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f70337f6000</span>, <span style="color:#ae81ff">2093056</span>, PROT_NONE) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(<span style="color:#ae81ff">0x7f70339f5000</span>, <span style="color:#ae81ff">8192</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, ..., <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x107000</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f70339f5000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close</span>(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">4096</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_ANONYMOUS, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034757000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">4096</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_ANONYMOUS, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034756000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">8192</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_ANONYMOUS, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034754000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">arch_prctl</span>(ARCH_SET_FS, <span style="color:#ae81ff">0x7f7034754740</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7033db6000</span>, <span style="color:#ae81ff">16384</span>, PROT_READ) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f70339f5000</span>, <span style="color:#ae81ff">4096</span>, PROT_READ) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mmap</span>(NULL, <span style="color:#ae81ff">4096</span>, PROT_READ<span style="color:#f92672">|</span>PROT_WRITE, MAP_PRIVATE<span style="color:#f92672">|</span>MAP_ANONYMOUS, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7f7034753000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7034348000</span>, <span style="color:#ae81ff">40960</span>, PROT_READ) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7034559000</span>, <span style="color:#ae81ff">4096</span>, PROT_READ) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x601000</span>, <span style="color:#ae81ff">4096</span>, PROT_READ) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mprotect</span>(<span style="color:#ae81ff">0x7f7034780000</span>, <span style="color:#ae81ff">4096</span>, PROT_READ) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">munmap</span>(<span style="color:#ae81ff">0x7f7034759000</span>, <span style="color:#ae81ff">150611</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">brk</span>(NULL) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1053000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">brk</span>(<span style="color:#ae81ff">0x1085000</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1085000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fstat</span>(<span style="color:#ae81ff">1</span>, st_mode<span style="color:#f92672">=</span>S_IFCHR<span style="color:#f92672">|</span><span style="color:#ae81ff">0620</span>, st_rdev<span style="color:#f92672">=</span><span style="color:#a6e22e">makedev</span>(<span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">1</span>), ...) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➎</span> <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;checking &#39;show_me_the_flag&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#ae81ff">28</span>checking <span style="color:#960050;background-color:#1e0010">&#39;</span>show_me_the_flag<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">28</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➏</span> <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;ok</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#ae81ff">3</span>ok
</span></span><span style="display:flex;"><span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➐</span> <span style="color:#a6e22e">exit_group</span>(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+++</span> exited with <span style="color:#ae81ff">1</span> <span style="color:#f92672">+++</span>
</span></span></code></pre></div><p>When tracing a program from the start, strace includes all the system calls used by the program interpreter to set up the process, making the output quite verbose. The first system call in the output is execve, which is called by your shell to launch the program ➊. After that, the program interpreter takes over and starts setting up the execution environment. This involves setting up memory regions and setting the correct memory access permissions using mprotect. Additionally, you can see the system calls used to look up and load the required dynamic libraries. The dynamic linker is searching for the lib5ae9b7f.so library in a number of standard subfolders, followed by in your current working directory (➋ /ch3) since LD_LIBRARY_PATH environment variable was set to it earlier to tell the dynamic linker to add your current working directory to its search path. When the library is found, the dynamic linker reads it and maps it into memory ➌. The setup process is repeated for other required libraries, such as libstdc++.so.6 ➍, and it accounts for the vast majority of the strace output. It isn’t until the last three system calls that you finally see application specific behavior. The first system call used is write, which is used to print checking &lsquo;show_me_the_flag&rsquo; to the screen ➎. You see another write call to print the string ok ➏, and finally, there’s a call to exit_group, which leads to the exit with status code 1 ➐.</p>
<p> </p>
<h2 id="library-call-trace">Library Call Trace</h2>
<p><strong>ltrace</strong> can be used to investigate system call behavior.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ltrace <span style="color:#f92672">-</span>i <span style="color:#f92672">-</span>C .<span style="color:#f92672">/</span>ctf show_me_the_flag
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➊</span> [<span style="color:#ae81ff">0x400fe9</span>] <span style="color:#a6e22e">__libc_start_main</span> (<span style="color:#ae81ff">0x400bc0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x7ffc22f441e8</span>, <span style="color:#ae81ff">0x4010c0</span> <span style="color:#f92672">&lt;</span>unfinished ...<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➋</span> [<span style="color:#ae81ff">0x400c44</span>] <span style="color:#a6e22e">__printf_chk</span> (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x401158</span>, <span style="color:#ae81ff">0x7ffc22f4447f</span>, <span style="color:#ae81ff">160</span>checking <span style="color:#960050;background-color:#1e0010">&#39;</span>show_me_the_flag<span style="color:#960050;background-color:#1e0010">&#39;</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">28</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➌</span> [<span style="color:#ae81ff">0x400c51</span>] <span style="color:#a6e22e">strcmp</span> (<span style="color:#e6db74">&#34;show_me_the_flag&#34;</span>, <span style="color:#e6db74">&#34;show_me_the_flag&#34;</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➍</span> [<span style="color:#ae81ff">0x400cf0</span>] <span style="color:#a6e22e">puts</span> (<span style="color:#e6db74">&#34;ok&#34;</span>ok) <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➎</span> [<span style="color:#ae81ff">0x400d07</span>] <span style="color:#a6e22e">rc4_init</span> (<span style="color:#66d9ef">rc4_state_t</span><span style="color:#f92672">*</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>, <span style="color:#66d9ef">int</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0x7ffc22f43fb0</span>, <span style="color:#ae81ff">0x4011c0</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">0x7fe979b0d6e0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➏</span> [<span style="color:#ae81ff">0x400d14</span>] std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;::</span> <span style="color:#a6e22e">assign</span> (<span style="color:#66d9ef">char</span> <span style="color:#66d9ef">const</span><span style="color:#f92672">*</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0x7ffc22f43ef0</span>, <span style="color:#ae81ff">0x40117b</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffc22f43ef0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➐</span> [<span style="color:#ae81ff">0x400d29</span>] <span style="color:#a6e22e">rc4_decrypt</span> (<span style="color:#66d9ef">rc4_state_t</span><span style="color:#f92672">*</span>, std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>, std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;&amp;</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0x7ffc22f43f50</span>, <span style="color:#ae81ff">0x7ffc22f43fb0</span>, <span style="color:#ae81ff">0x7ffc22f43ef0</span>, <span style="color:#ae81ff">0x7e889f91</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffc22f43f50</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➑</span> [<span style="color:#ae81ff">0x400d36</span>] std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;::</span> <span style="color:#a6e22e">_M_assign</span> (std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>, std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">const</span><span style="color:#f92672">&amp;</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0x7ffc22f43ef0</span>, <span style="color:#ae81ff">0x7ffc22f43f50</span>, <span style="color:#ae81ff">0x7ffc22f43f60</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➒</span> [<span style="color:#ae81ff">0x400d53</span>] <span style="color:#a6e22e">getenv</span> (<span style="color:#e6db74">&#34;GUESSME&#34;</span>) <span style="color:#f92672">=</span> nil
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0xffffffffffffffff</span>] <span style="color:#f92672">+++</span> <span style="color:#a6e22e">exited</span> (status <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+++</span>
</span></span></code></pre></div><p>The first library call is __libc_start_main ➊, which is called from the _start function to transfer control to the program’s main function. Once main is started, its first library call prints the now familiar checking &hellip; string to the screen ➋. The actual check turns out to be a string comparison, which is implemented using strcmp, and verifies that the argument given to ctf is equal to show_me_the_flag ➌. If this is the case, ok is printed to the screen ➍. So far, this is mostly behavior you’ve seen before. But now you see something new: the RC4 cryptography is initialized through a call to rc4_init, which is located in the library you extracted earlier ➎. After that, you see an assign to a C++ string, presumably initializing it with an encrypted message ➏. This message is then decrypted with a call to rc4_decrypt ➐, and the decrypted message is assigned to a new C++ string ➑. Finally, there’s a call to getenv, which is a standard library function used to look up environment variables ➒. You can see that ctf expects an environment variable called GUESSME! The name of this variable may well be the string that was decrypted earlier. Let’s see whether ctf ’s behavior changes when you set a dummy value for the GUESSME environment variable as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> GUESSME<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>foobar<span style="color:#960050;background-color:#1e0010">&#39;</span> ltrace <span style="color:#f92672">-</span>i <span style="color:#f92672">-</span>C .<span style="color:#f92672">/</span>ctf show_me_the_flag
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0x400d53</span>] <span style="color:#a6e22e">getenv</span> (<span style="color:#e6db74">&#34;GUESSME&#34;</span>) <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;foobar&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➊</span> [<span style="color:#ae81ff">0x400d6e</span>] std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;::</span> <span style="color:#a6e22e">assign</span> (<span style="color:#66d9ef">char</span> <span style="color:#66d9ef">const</span><span style="color:#f92672">*</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0x7fffc7af2b00</span>, <span style="color:#ae81ff">0x401183</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7fffc7af2b00</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➋</span> [<span style="color:#ae81ff">0x400d88</span>] <span style="color:#a6e22e">rc4_decrypt</span> (<span style="color:#66d9ef">rc4_state_t</span><span style="color:#f92672">*</span>, std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>, std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;&amp;</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0x7fffc7af2b60</span>, <span style="color:#ae81ff">0x7fffc7af2ba0</span>, <span style="color:#ae81ff">0x7fffc7af2b00</span>, <span style="color:#ae81ff">0x401183</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7fffc7af2b60</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0x400d9a</span>] std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;::</span> <span style="color:#a6e22e">_M_assign</span> (std<span style="color:#f92672">::</span>__cxx11<span style="color:#f92672">::</span>basic_string<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>,
</span></span><span style="display:flex;"><span>std<span style="color:#f92672">::</span>char_traits<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>, std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">const</span><span style="color:#f92672">&amp;</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0x7fffc7af2b00</span>, <span style="color:#ae81ff">0x7fffc7af2b60</span>, <span style="color:#ae81ff">0x7700a0</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0x400db4</span>] operator <span style="color:#a6e22e">delete</span> (<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span>)(<span style="color:#ae81ff">0x7700a0</span>, <span style="color:#ae81ff">0x7700a0</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➌</span> [<span style="color:#ae81ff">0x400dd7</span>] <span style="color:#a6e22e">puts</span> (<span style="color:#e6db74">&#34;guess again!&#34;</span>guess again<span style="color:#f92672">!</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0x400c8d</span>] operator <span style="color:#a6e22e">delete</span> (<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span>)(<span style="color:#ae81ff">0x770050</span>, <span style="color:#ae81ff">0x76fc20</span>, <span style="color:#ae81ff">0x7f70f99b3780</span>, <span style="color:#ae81ff">0x7f70f96e46e0</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0xffffffffffffffff</span>] <span style="color:#f92672">+++</span> <span style="color:#a6e22e">exited</span> (status <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+++</span>
</span></span></code></pre></div><p>After the call to getenv, ctf goes on to assign ➊ and decrypt ➋ another C++ string. Unfortunately, between the decryption and the moment that guess again is printed to the screen ➌, you don’t see any hints regarding the expected value of GUESSME. This tells you that the comparison of GUESSME to its expected value is implemented without the use of any library functions.</p>
<p>Citation: <a href="https://nostarch.com/binaryanalysis">Practical Binary Analysis</a>.</p>

        </div>
    </article>

    <hr />

    <div class="post-info">
        <p>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-tag meta-icon">
                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                <line x1="7" y1="7" x2="7" y2="7"></line>
            </svg><span class="tag"><a href="https://blogs.hexterisk.com/%20tags/binary">binary</a></span><span class="tag"><a href="https://blogs.hexterisk.com/%20tags/rev">rev</a></span><span class="tag"><a href="https://blogs.hexterisk.com/%20tags/reversing">reversing</a></span><span class="tag"><a href="https://blogs.hexterisk.com/%20tags/c">c</a></span><span class="tag"><a href="https://blogs.hexterisk.com/%20tags/pe">pe</a></span><span class="tag"><a href="https://blogs.hexterisk.com/%20tags/windows">windows</a></span>
        </p>

        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-file-text">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>1333 Words</p>

        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-calendar">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>2020-03-25 05:30 &#43;0530</p>
    </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">

            
            <span class="button previous">
                <a href="https://blogs.hexterisk.com/posts/2020/03/19/stack-and-its-frames/">
                    <span class="button__text">Stack and it&#39;s Frames</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://blogs.hexterisk.com/posts/2020/04/02/disassembly-and-binary-analysis-fundamentals/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Disassembly and Binary Analysis Fundamentals</span>
                </a>
            </span>
            

        </div>
    </div>
    

    
</main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
    
    <div class="footer__svg">
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="30"
            height="30"
            viewBox="0 0 140 140"
            stroke="#4DB6AC"
        >
            <path stroke-width="122" stroke-dasharray="2,38" d="M9,70h122M70,9v122" />
            <path stroke-width="33" stroke-linecap="round" d="M70,30h0M110,70h0M30,110v0M70,110h0M110,110h0" />
        </svg>
    </div>
</footer>
            
        </div>

        





<script type="text/javascript" src="../../../../../bundle.min.45295cbc2d5bbc09b85caead90108f31defa5c6b650a42abb2e79d59a363e5bc2f11614e43687e66e6d47563560a45c3324b75dcb9b3a724a2955a2f1ce2f114.js" integrity="sha512-RSlcvC1bvAm4XK6tkBCPMd76XGtlCkKrsuedWaNj5bwvEWFOQ2h&#43;ZubUdWNWCkXDMkt13LmzpySilVovHOLxFA=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'G-66L1D38RLD', 'auto');
        ga('send', 'pageview');
    </script>


    </body>
</html>
