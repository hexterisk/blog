<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:hexterisk]">
<meta name="description" content="Classification of malware traffic has been a hot topic ever since machine learning was introduced to the world of network security domain. There are a number of published researches that explore various techniques to extract features from the traffic and use it classification.
The pre-machine learning era saw classification of traffic based on structured rule matching, DPI(Deep Packet Inspection) and Port Inspection being the most popular methods, which were typically rendered ineffective post-encryption." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://hexterisk.github.io/blog/posts/2020/08/22/classification-of-malware-traffic-using-cnns/" />


    <title>
        
            Classification of Malware Traffic using CNNs: Pwn the world.  — A noob&#39;s attempt at blogging.
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://hexterisk.github.io/blog/main.min.bc21949b46a7b314448099a92fed1807acac025093285f474b88259eec0c62ba.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://hexterisk.github.io/blog/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://hexterisk.github.io/blog/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://hexterisk.github.io/blog/favicon-16x16.png">
    <link rel="manifest" href="https://hexterisk.github.io/blog/site.webmanifest">
    <link rel="mask-icon" href="https://hexterisk.github.io/blog/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://hexterisk.github.io/blog/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">

<meta itemprop="name" content="Classification of Malware Traffic using CNNs">
<meta itemprop="description" content="Classification of malware traffic has been a hot topic ever since machine learning was introduced to the world of network security domain. There are a number of published researches that explore various techniques to extract features from the traffic and use it classification.
The pre-machine learning era saw classification of traffic based on structured rule matching, DPI(Deep Packet Inspection) and Port Inspection being the most popular methods, which were typically rendered ineffective post-encryption."><meta itemprop="datePublished" content="2020-08-22T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-08-22T00:00:00+00:00" />
<meta itemprop="wordCount" content="652"><meta itemprop="image" content="https://hexterisk.github.io/blog"/>
<meta itemprop="keywords" content="malwares,machine-learning,network,traffic,cnn,flow," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://hexterisk.github.io/blog"/>

<meta name="twitter:title" content="Classification of Malware Traffic using CNNs"/>
<meta name="twitter:description" content="Classification of malware traffic has been a hot topic ever since machine learning was introduced to the world of network security domain. There are a number of published researches that explore various techniques to extract features from the traffic and use it classification.
The pre-machine learning era saw classification of traffic based on structured rule matching, DPI(Deep Packet Inspection) and Port Inspection being the most popular methods, which were typically rendered ineffective post-encryption."/>



    <meta property="article:section" content="ml-for-sec" />



    <meta property="article:published_time" content="2020-08-22 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://hexterisk.github.io/blog/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$cd ~/</span>
            <span class="logo__cursor" style=""></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://hexterisk.github.io/blog/about/">About</a></li><li><a href="https://hexterisk.github.io/blog/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
<main class="post">

    <div class="post-info">
        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-clock">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>4 minutes

            

        </p>
    </div>

    <article>
        <h1 class="post-title">
            <a href="https://hexterisk.github.io/blog/posts/2020/08/22/classification-of-malware-traffic-using-cnns/">Classification of Malware Traffic using CNNs</a>
        </h1>

        

        <div class="post-content">
            <p>Classification of malware traffic has been a hot topic ever since machine learning was introduced to the world of network security domain. There are a number of published researches that explore various techniques to extract features from the traffic and use it classification.</p>
<p>The pre-machine learning era saw classification of traffic based on structured rule matching, <strong>DPI</strong>(<strong>Deep Packet Inspection</strong>) and <strong>Port Inspection</strong> being the most popular methods, which were typically rendered ineffective post-encryption.</p>
<p>The post-machine learning era saw classical statistical and behavioral approaches towards classification. These were fairly effective since they worked well with patterns extracted from data with highly selective features.</p>
<p>Representation Learning is a methodology allowing a system to form &ldquo;representations&rdquo; out of raw data to automatically learn features, preventing us from the painstaking task of hand-designing features.</p>
<p>Considering a set of raw data, the raw bytes can be used to form images. Since structured bytes would give well-formed patterns, these patterns would be visible in images. This allows for learning meaningful feature representations from the image. Thus, convolutional models would be an excellent choice for this task.</p>
<p> </p>
<h2 id="traffic-granularity">Traffic Granularity</h2>
<p>The traffic capture can be split into different levels of granularity.</p>
<p>For a set of packets <em>P</em>, let <em>P = {p1, …, pn }</em>.</p>
<p>For the <em>ith</em> packet <em>p</em> in the set <em>P</em>, <em>pi = {xi, bi, ti}</em>, </p>
<p>where,</p>
<p><em>xi</em> is a tuple of source IP, source port, destination IP, destination port and transport-level protocol.</p>
<p><em>bi</em> is the size of the packet.</p>
<p><em>ti</em> is the time of transmission of the packet.</p>
<h3 id="raw-traffic">Raw Traffic</h3>
<p>All packets can be considered individually. There&rsquo;s no specific structure to this granularity since any packet can belong to any device&rsquo;s network flow. This could be a good granularity level for analyzing the flow of traffic in a generic sense, but not when we need to fingerprint malicious traffic.</p>
<h3 id="flow">Flow</h3>
<p>A set of packets travelling from one device to another is the “flow” of the traffic. The flow can be defined as <em>f = (x, b, d, t)</em>,</p>
<p>where, </p>
<p><em>x</em> is generalized since the tuple <em>xi</em> for the <em>ith</em> packet would be the exact same as all the other packets in this subset, since they all have the same origin and destination.</p>
<p><em>b = ∑ibi for i in the set of all packets in the flow</em>, the total size of the flow. It&rsquo;s the sum of size of all packets in the flow.</p>
<p><em>d</em> = <em>tn - t1</em>, the duration of the flow.</p>
<p><em>t</em> is the starting time of the transmission.</p>
<h3 id="session">Session</h3>
<p>A session is bidirectional, that is, it&rsquo;s the back and forth flow of traffic between two devices. Therefore, it&rsquo;s the same as a flow, except the first element <em>x</em> won&rsquo;t be the same throughout, but would be either of two different tuples since now the source IP/port and destination IP/port pairs would be interchangeable.</p>
<p> </p>
<h2 id="layers">Layers</h2>
<p>The data in the application layer, that is, the 7th layer of the OSI model would harbor characteristic that would be intrinsic to a particular application such as SMTP structured data would represent email traffic where as HTTP structured data would represent browser traffic.</p>
<p>However, data from other layers, such as the port number, can also help deduce the application to which the traffic flow belongs (might be misleading since usage of default ports isn&rsquo;t guaranteed for all applications).</p>
<p>Thus, another variation of the dataset can be created where only the 7th layer is considered.</p>
<p>NOTE: Removal of IP addresses and MAC addresses since they might end up being counted as features. These are only required to identify the origin and the destination of the traffic and have no bearing over the kind of traffic that is present. Moreover, in the same network, they won&rsquo;t even be a piece of distinguishing information.</p>
<p>Citation:</p>
<p>Wang, Wei &amp; Zhu, Ming &amp; Zeng, Xuewen &amp; Ye, Xiaozhou &amp; Sheng, Y.. (2017). Malware traffic classification using convolutional neural network for representation learning. 712-717. 10.1109/ICOIN.2017.7899588.</p>

        </div>
    </article>

    <hr />

    <div class="post-info">
        <p>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-tag meta-icon">
                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                <line x1="7" y1="7" x2="7" y2="7"></line>
            </svg><span class="tag"><a href="https://hexterisk.github.io/blog/%20tags/malwares">malwares</a></span><span class="tag"><a href="https://hexterisk.github.io/blog/%20tags/machine-learning">machine-learning</a></span><span class="tag"><a href="https://hexterisk.github.io/blog/%20tags/network">network</a></span><span class="tag"><a href="https://hexterisk.github.io/blog/%20tags/traffic">traffic</a></span><span class="tag"><a href="https://hexterisk.github.io/blog/%20tags/cnn">cnn</a></span><span class="tag"><a href="https://hexterisk.github.io/blog/%20tags/flow">flow</a></span>
        </p>

        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-file-text">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>652 Words</p>

        <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-calendar">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>2020-08-22 05:30 &#43;0530</p>
    </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">

            
            <span class="button previous">
                <a href="https://hexterisk.github.io/blog/posts/2020/08/04/classification-of-malwares-through-dynamic-analysis/">
                    <span class="button__text">Classification of Malwares through Dynamic Analysis</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://hexterisk.github.io/blog/posts/2020/09/05/introduction/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Introduction</span>
                </a>
            </span>
            

        </div>
    </div>
    

    
</main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content" style="margin-bottom: -0.8rem;">
            <span><a style="text-decoration: none;"> .</a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span><a style="text-decoration: none;" style="font-size: 1.4rem; margin-bottom: -1.0rem;">..:</a></span>
        </div>
    </div>
</footer>
            
        </div>

        




<script type="text/javascript" src="https://hexterisk.github.io/blog/bundle.min.08ccaf9cef8b4e0ebd0b0158e66a7bfc0ddbb2194cdb0099e8814ddb89cc7628b27b1158846564e6e03d9ffc5f4d1bc7dfc274d359f9408d1c63d73a3f7332e9.js" integrity="sha512-CMyvnO&#43;LTg69CwFY5mp7/A3bshlM2wCZ6IFN24nMdiiyexFYhGVk5uA9n/xfTRvH38J001n5QI0cY9c6P3My6Q=="></script>



    </body>
</html>
